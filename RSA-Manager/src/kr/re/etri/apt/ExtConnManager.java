package kr.re.etri.apt;

import java.sql.SQLException;

public class ExtConnManager extends Thread{
	
	DbConnection dbm;
	
	String[] hPool;
	
	String host_ip;
	
	public ExtConnManager(DbConnection d, String ip){
		
		
		this.dbm = d;
		
		host_ip = ip;
		
		/*
		pList = {"svchost.exe","vmtoolsd.exe","TPAutoConnSvc.exe","Explorer.EXE",
				"SearchIndexer.exe","wininit.exe","lsass.exe","taskhost.exe","winlogon.exe","services.exe",
				"lsm.exe","spoolsv.exe","dllhost.exe","msdtc.exe","Dwm.exe","TPAutoConnect.exe","conhost.exe",
				"mscorsvw.exe","sppsvc.exe","wmiprvse.exe","cmd.exe","SearchProtocolHost.exe","SearchFilterHost.exe","Nmdeputy.exe",
				"tvnserver.exe","vmnat.exe","vmnetdhcp.exe","vmware-usbarbitrator64.exe","vmware-authd.exe","vmware-hostd.exe","WUDFHost.exe",
				"vmware-tray.exe","jusched.exe","OutProcSite.exe","ComBack.exe","YiStart.exe","WMIADAP.EXE","jucheck.exe","javaw.exe"};
		*/
		
		
		/*
		String[] p= {"svchost.exe","vmtoolsd.exe","TPAutoConnSvc.exe","Explorer.EXE",
				"SearchIndexer.exe","wininit.exe","lsass.exe","taskhost.exe","winlogon.exe","services.exe","lsm.exe",
				"spoolsv.exe","dllhost.exe","msdtc.exe","Dwm.exe","TPAutoConnect.exe","conhost.exe","mscorsvw.exe","sppsvc.exe","wmiprvse.exe",
				"cmd.exe","SearchProtocolHost.exe","SearchFilterHost.exe","Nmdeputy.exe","tvnserver.exe","vmnat.exe","vmnetdhcp.exe","vmware-usbarbitrator64.exe",
				"vmware-authd.exe","vmware-hostd.exe","WUDFHost.exe","vmware-tray.exe","jusched.exe","OutProcSite.exe","ComBack.exe","YiStart.exe","WMIADAP.EXE",
				"jucheck.exe","javaw.exe","","svchost.exe","TPAutoConnSvc.exe","vmtoolsd.exe","Explorer.EXE","SearchIndexer.exe","mscorsvw.exe","lsass.exe","taskhost.exe",
				"services.exe","wininit.exe","winlogon.exe","lsm.exe","spoolsv.exe","dllhost.exe","msdtc.exe","Dwm.exe","TPAutoConnect.exe","conhost.exe","sppsvc.exe","cmd.exe",
				"WMIADAP.EXE","wmiprvse.exe","SearchProtocolHost.exe","SearchFilterHost.exe","consent.exe","IEInstal.exe","InstallFlashPlayer.exe", "Hwp.exe", "MSWord.exe"};
		*/
		
		
		String[] p= {"129.254.38.39","10.10.30.1","129.254.185.54","129.254.186.40","129.254.186.143","211.181.210.176","157.56.144.215","129.254.74.239","129.254.185.195","129.254.75.202","129.254.9.22","173.194.70.100","108.160.163.110","129.254.75.25","149.154.171.5","129.254.16.204","129.254.180.218","255.255.255.255","192.126.120.72","129.254.38.40","173.194.72.188","129.254.38.44","129.254.31.4","1.201.0.57","195.12.48.190","129.254.15.35","162.255.119.254","80.94.26.250","204.154.94.81","173.194.72.189","74.125.31.188","146.255.96.17","129.254.26.7","125.209.230.166","118.123.245.176","192.126.120.71","192.126.120.58","192.126.120.87","192.126.120.83","192.126.120.86","224.0.0.252","165.244.62.22","114.111.42.145","159.253.4.167","213.192.92.3","101.79.245.61","224.0.0.251","74.125.203.188","121.254.188.138","79.133.192.206","212.175.86.17","125.209.230.195","74.125.204.188","202.179.179.108","212.58.4.190","1.201.1.234","129.254.15.15","173.194.126.181","195.175.227.173","195.184.9.198","118.131.14.181","157.56.106.189","222.136.81.3","198.252.206.25","173.194.126.182","109.104.94.2","125.209.226.239","112.175.23.195","192.126.120.36","202.131.30.11","74.125.23.189","173.194.72.95","123.215.198.11","192.229.145.200","74.125.23.188","103.246.57.52","74.125.31.189","173.240.5.1","149.154.167.51","173.223.227.17","209.49.122.52","110.76.141.124","144.0.0.28","183.111.23.32","74.125.204.189","74.125.31.95","178.151.195.163","239.255.255.250","202.179.179.56","198.20.72.170","173.194.72.84","192.31.186.4","192.126.120.33","125.209.226.161","60.173.14.139","173.194.126.149","74.125.235.85","98.138.112.37","211.199.232.182","178.18.137.179","23.49.155.27","103.6.174.9","103.6.174.10","218.153.8.59","192.126.120.81","98.136.216.25","98.138.112.38","184.25.80.183","202.179.179.57","10.12.10.11","173.223.227.11","121.127.253.169","98.138.112.32","193.222.50.2","239.255.255.253","74.125.23.95","66.196.118.33","219.148.111.247","209.49.122.59","110.45.229.135","98.136.217.203","64.62.151.130","125.209.230.238","66.196.118.35","66.196.118.240","64.62.151.132","59.63.175.10","66.196.118.37","98.136.217.202","63.250.192.46","74.125.203.189","101.79.247.25","98.138.112.35","74.125.31.84","173.194.126.178","101.79.247.47","74.125.194.27","175.158.1.94","98.136.216.26","74.125.130.188","74.125.207.27","173.194.126.191","74.125.194.26","66.196.118.36","188.6.195.128","202.43.59.213","65.55.57.27","66.196.118.34","63.250.192.45","223.255.205.221","206.19.49.139","98.138.112.33","173.194.71.26","14.50.147.54","60.173.14.146","129.254.19.28","74.125.207.26","62.210.124.18","222.122.117.12","85.10.192.180","173.194.126.184","98.138.112.34","101.79.247.46","101.79.247.48","101.79.245.74","143.248.234.110","74.125.23.84","50.89.246.83","82.216.49.22","173.194.126.179","121.156.109.44","224.0.0.253","64.233.185.26","23.76.153.66","221.141.1.98","173.194.126.162","202.131.24.231","125.209.210.54","209.49.122.54","171.35.103.23","125.209.238.147","173.194.126.177","173.223.227.57","125.209.210.53","173.194.126.169","94.153.54.83","78.192.186.98","173.194.126.183","125.209.214.40","125.209.222.141","173.194.126.174","74.125.203.95","64.233.185.27","173.194.126.173","173.194.126.176","173.194.71.27","62.212.128.22","182.162.92.12","173.194.126.161","211.45.28.16","121.156.79.18","173.194.126.167","125.209.222.142","174.1.194.18","74.125.193.26","23.76.153.59","70.122.127.156","182.162.92.21","23.76.153.64","157.56.141.102","108.180.13.10","173.194.126.185","61.247.193.235","188.125.69.79","64.12.88.131","174.79.47.162","173.194.126.164","1.255.33.40","108.160.162.103","74.125.193.27","173.194.126.166","74.125.204.95","173.194.126.175","125.209.210.79","182.162.92.13","61.110.197.50","64.12.88.163","182.162.92.34","182.162.92.19","64.233.162.27","64.4.11.42","173.223.227.27","202.131.30.12","23.76.153.74","64.12.88.164","64.12.91.195","24.85.74.79","180.70.134.239","121.156.109.45","64.233.162.26","117.18.237.139","66.15.76.101","78.62.35.154","211.233.40.78","182.162.92.17","24.191.48.132","78.96.5.87","211.233.84.186","74.125.203.84","173.194.126.165","64.12.88.132","64.12.91.196","23.49.149.163","182.162.92.31","121.172.98.21","117.21.191.195","124.248.37.178","101.79.247.4","173.194.68.27","202.43.59.227","62.210.99.183","68.0.20.184","203.250.198.114","61.247.209.238","121.254.188.137","17.110.225.84","74.125.204.84","64.233.164.26","182.162.92.18","101.79.247.81","125.141.130.230","173.194.126.186","58.123.220.237","65.55.53.190","93.80.5.209","64.233.164.27","182.162.92.26","5.135.167.215","64.233.165.26","143.248.48.166","182.162.92.16","61.247.193.236","14.37.138.82","112.186.16.243","164.124.119.178","198.27.66.134","199.59.149.201","24.95.48.132","58.143.10.65","221.166.212.65","182.162.92.22","119.206.16.140","125.209.222.15","173.194.68.26","121.156.109.2","58.229.92.104","125.141.130.119","182.162.92.23","218.153.8.240","121.156.79.17","182.162.92.20","106.185.38.130","204.127.217.21","182.162.92.24","220.127.176.132","182.162.92.32","211.216.128.183","218.16.129.142","182.185.54.83","173.194.126.163","113.142.37.210","182.162.92.33","173.194.126.180","182.162.92.25","76.108.121.75","125.209.210.116","202.131.27.204","61.247.193.200","211.117.39.45","182.162.92.11","121.156.109.46","173.194.126.168","222.122.117.40","121.156.79.14","211.106.65.137","173.194.126.172","211.117.39.59","173.194.126.171","1.255.33.49","183.110.238.108","112.175.52.62","182.162.92.15","46.55.145.233","14.0.63.209","182.162.92.37","123.215.198.9","144.76.166.139","58.229.92.118","128.73.101.95","36.38.34.9","64.233.165.27","212.54.195.128","121.125.79.185","173.194.126.160","101.79.247.2","182.162.92.14","121.156.79.13","83.254.196.46","76.110.183.193","58.123.220.172","175.39.12.184","114.111.42.142","184.25.80.192","1.255.22.34","173.194.126.170","67.225.255.114","211.117.39.50","174.79.47.194","125.141.130.232","58.123.220.231","90.0.197.87","129.254.16.253","46.200.177.22","182.162.202.180","58.229.92.119","112.162.26.50","211.106.65.154","1.255.22.109","58.123.220.178","174.79.47.163","200.222.183.193","182.162.92.38","152.163.0.99","70.177.2.18","178.92.42.71","1.255.22.104","1.255.22.29","1.255.22.88","74.125.22.26","202.131.30.43","216.110.247.193","58.123.220.251","86.130.178.38","65.54.188.72","152.163.0.100","152.163.0.68","175.197.208.166","211.117.39.34","99.250.174.93","199.59.150.46","82.35.138.189","173.194.126.187","14.0.63.246","31.132.160.116","101.79.244.38","121.128.200.10","61.174.51.215","58.230.54.121","101.79.244.39","58.123.220.216","1.255.22.167","86.8.226.217","134.170.184.133","191.234.231.250","1.255.33.55","114.111.42.141","125.209.226.185","58.123.220.148","1.255.22.98","58.229.92.99","69.171.230.5","1.255.52.80","88.206.53.34","46.40.113.22","121.156.109.3","129.254.180.1","129.254.38.230","182.162.92.35","58.123.102.104","152.163.0.67","195.22.3.250","129.254.16.61","99.129.1.166","221.145.183.11","78.58.185.185","58.123.220.173","118.214.66.217","176.37.138.79","98.242.203.221","23.76.153.48","65.55.92.152","176.96.247.111","76.167.196.197","58.123.220.187","1.255.22.94","1.255.22.178","186.34.11.221","1.255.22.216","1.255.22.99","1.255.33.34","1.255.22.183","184.28.152.164","1.255.33.24","1.255.22.226","58.229.92.88","65.55.33.119","182.162.59.53","118.214.74.34","125.141.130.120","17.110.226.81","125.141.130.231","130.83.70.33","74.125.196.27","1.93.36.87","1.255.22.182","84.20.77.10","99.251.216.58","1.93.34.230","1.255.33.44","58.123.220.177","1.255.22.251","1.255.33.39","211.106.65.150","125.209.210.75","180.26.176.42","23.76.153.42","1.255.22.24","117.52.11.181","103.246.57.97","1.255.22.163","1.255.33.30","82.217.108.55","142.161.66.18","174.49.68.55","173.194.126.213","61.78.36.18","207.46.8.199","82.169.65.176","1.255.22.177","194.12.42.71","58.123.102.88","58.229.92.123","1.255.22.119","148.251.8.106","24.247.138.108","58.123.102.94","115.186.173.235","1.255.22.222",
				"122.241.66.18","91.232.140.79","62.210.151.174","65.55.37.88","118.214.78.133","211.117.39.49","67.232.131.178","82.80.133.87","1.255.22.89","212.143.41.205","178.194.68.233","1.255.22.123"};
	
		
		hPool = p;
		
	}

	
	public void run(){
		
		while(true){
			
			//DELETE FROM network_traffic_graph WHERE currentTIme <= date_add(now(), interval -3 minute);
			String delete = new String("DELETE FROM ext_host_list_info WHERE host_ip=\'"+host_ip+"\'");
			System.out.println(delete);
			
			try {
				dbm.stmt.executeUpdate(delete);
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			
			//입력할 갯
			int r = (int)(Math.random()*5)+20;
			
			//int k = pList.length;
			
			for(int i = 0; i < r ; i++){
				int pl = (int)(Math.random()* hPool.length);
		
				String insert = new String("INSERT ext_host_list_info SET ext_ip = \'"+hPool[pl]+"\', host_ip=\'"+host_ip+"\';");
				System.out.println(insert);
				
				try {
					dbm.stmt.executeUpdate(insert);
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
				
			}
			
			
			try {
				Thread.sleep(20000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}
	
	
}
